{"version":3,"sources":["../../src/components/Editor.jsx"],"names":["namespace","pluginConfigKeys","key","title","React","forwardRef","oneSignal","props","ref","useState","valueArea","setValueArea","valueTitle","setValueTitle","valueURL","setValueURL","secrets","showSettings","setShowSettings","useEffect","sendNotification","message","res","method","url","headers","Authorization","apiKey","data","app_id","appId","outline","event","currentTarget","value","marginLeft","contents","en","headings","included_segments"],"mappings":"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","sourcesContent":["import * as React from 'react'\r\nimport {Card, TextArea, TextInput, Text, Button, Box} from '@sanity/ui'\r\nimport axios from 'axios'\r\nimport {useSecrets, SettingsView} from 'sanity-secrets'\r\n\r\nconst namespace = 'onesignal'\r\n\r\nconst pluginConfigKeys = [\r\n  {\r\n    key: 'apiKey',\r\n    title: 'OneSignal Api Key',\r\n  },\r\n  {\r\n    key: 'appId',\r\n    title: 'OneSignal App ID',\r\n  },\r\n]\r\n\r\nexport default React.forwardRef(function oneSignal(props, ref) {\r\n  const [valueArea, setValueArea] = React.useState('')\r\n  const [valueTitle, setValueTitle] = React.useState('')\r\n  const [valueURL, setValueURL] = React.useState('')\r\n  const {secrets} = useSecrets(namespace)\r\n  const [showSettings, setShowSettings] = React.useState(false)\r\n\r\n  React.useEffect(() => {\r\n    if (!secrets) {\r\n      setShowSettings(true)\r\n    }\r\n  }, [secrets])\r\n\r\n  async function sendNotification(message) {\r\n    let res = await axios({\r\n      method: 'post',\r\n      url: 'https://onesignal.com/api/v1/notifications',\r\n      headers: {\r\n        'Content-Type': 'application/json; charset=utf-8',\r\n        Authorization: `Basic ${secrets.apiKey}`,\r\n      },\r\n      data: {app_id: secrets.appId, ...message},\r\n    })\r\n\r\n    return res.data\r\n  }\r\n\r\n  return (\r\n    <Card padding={4}>\r\n      <Box padding={[3, 3, 4, 5]} style={{outline: '2px solid rgb(240 240 240)'}}>\r\n        <Text size={9}>Notification Title:</Text>\r\n        <br />\r\n        <TextInput\r\n          value={valueTitle}\r\n          onChange={(event) => setValueTitle(event.currentTarget.value)}\r\n          required\r\n        />\r\n        <br />\r\n        <Text size={9}>Notification Url:</Text>\r\n        <br />\r\n        <TextInput\r\n          value={valueURL}\r\n          onChange={(event) => setValueURL(event.currentTarget.value)}\r\n          required\r\n        />\r\n        <br />\r\n        <Text size={9}>Notification Content:</Text>\r\n        <br />\r\n        <TextArea\r\n          onChange={(event) => setValueArea(event.currentTarget.value)}\r\n          padding={[3, 3, 4]}\r\n          value={valueArea}\r\n          required\r\n        />\r\n        <br />\r\n        <Button\r\n          style={{marginLeft: '15px'}}\r\n          padding={[3, 3, 4]}\r\n          text=\"Publish Notification\"\r\n          tone=\"primary\"\r\n          onClick={async () =>\r\n            await sendNotification({\r\n              contents: {en: valueArea},\r\n              headings: {en: valueTitle},\r\n              url: valueURL ? valueURL : '',\r\n              included_segments: ['Subscribed Users'],\r\n            })\r\n          }\r\n        />\r\n        {showSettings && (\r\n          <SettingsView\r\n            namespace={namespace}\r\n            keys={pluginConfigKeys}\r\n            onClose={() => {\r\n              setShowSettings(false)\r\n            }}\r\n          />\r\n        )}\r\n      </Box>\r\n    </Card>\r\n  )\r\n})\r\n"],"file":"Editor.js"}